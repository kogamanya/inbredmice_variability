---
title: "Bioinfomatics exercise of all sessions"
author: "Kingsley"
date: "10/05/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Session 1

## Homework questions for study

1. calculate the sum of all integers numbers between 500 and 600

2. calculate the sum of all the square roots of all integers between 900 and 1000

3. Create the following datasets and plot a boxplot:

  a. A Sample 10000 datapoints from a normal distribution with mean of 50 and SD       of 5
  
  b. A Sample 10000 datapoints from a normal distribution with mean of 50 and SD       of 10 

4. Plot a and b above as a scatterplot, and plot the trend line.

5. Plot a and b above as histograms on the same chart.


## Question 1, calculating the sum of all integers numbers between 500 and 600
```{r, math1}
a <- c(500:600)
a
as.integer(a)
sum(a)
```

## Question 2, calculating the sum of all the square roots of all intergers between 900 and 1000
```{r, math2}
x <- c(900:1000)
x
as.integer(x)
sqrt(x)
sum(sqrt(x))
```

## Question 3a, create a sample of 1000 datapoints from a normal distribution with mean of 50 and SD of 5 and then plot a boxplot
```{r, math3a}
d <- rnorm(n = 1000, mean = 50, sd = 5)
d
```

## Question 3b, create a sample of 1000 datapoints from a normal distribution with mean of 50 and SD of 10 and then plot a boxplot
```{r, math3b}
b <- rnorm(n = 1000, mean = 50, sd = 10)
b
```

boxplots for a and b above
```{r,boxplots1}
boxplot(d, y_axis/2)
boxplot(d, y_axis/2, names=c("X values", "Y values"),ylab="Measurement (cm)")
```

## Including Plots

```{r, plots1}
y_axis <- d*b
y_axis

plot(x=d, y=y_axis, xlab="my x values", ylab="my y values")

plot(x=d, y=y_axis, xlab="my x values", ylab="my y values",pch=19, cex=0.5, main="Plot of X and Y values")

plot(x=d, y=y_axis, xlab="my x values", ylab="my y values",pch=19, cex=0.5, main="Plot of X and Y values")
points(x=d, y=y_axis/2, pch=19, cex=0.5,col="blue")

plot(x=d, y=y_axis, xlab="my x values", ylab="my y values",pch=20, 
     cex=0.5, main="Plot of X and Y values",
     ylim=c(0,17))
points(x=d, y=y_axis/2, pch=20, cex=0.5,col="blue")

```

```{r,scatter2}
linear_regression_model <- lm(y_axis ~ d)

summary(linear_regression_model)

SLOPE <- linear_regression_model$coefficients[1]
INTERCEPT <- linear_regression_model$coefficients[2]

HEADER <- paste("Slope:",signif(SLOPE,4),"Intercept:",signif(INTERCEPT,4))

plot(x=d, y=y_axis, xlab="my x values", ylab="my y values",pch=19, cex=0.5)
abline(linear_regression_model,col="red",lty=2,lwd=3)
mtext(HEADER)
```

Ploting a and b above on same histogram charts
```{r,histograms1}
hist(d)

par(mfrow = c(2, 1))
hist(d,main="")
hist(y_axis,main="")
```

# Session 2

## Checking my understanding 

solving the questions below.

1. Create a scatterplot of mtcars weight (x axis) versus mpg (y axis). 
Include x and y axis labels and a main heading.

2. Sort mtcars by weight (wt) and create a horizontal barplot of wt values so heaviest ones at shown at the top of the bar plot.
The plot should be labeled so it is clear to see which bar belong to which car.
Include an axis label and main title.

3. Create a box plot of iris petal lengths.
Each species should be a different category.
Chart needs axis labels and a main title.

```{r, question1}
mtcars[,c("wt","mpg")]
mylm <- lm(mtcars$wt ~ mtcars$mpg)
plot(mtcars$wt,mtcars$mpg, 
     xlab="weight",
     ylab="mpg",
     main="Mtcars weight and mpg",
     pch=19)
```

```{r, question2}
mycars <- mtcars[order(mtcars$wt),]
par(mar=c(5,12,5,3))
barplot(mycars$wt, xlim= c(0,6), horiz=TRUE,las=1,names.arg=rownames(mycars),cex.names=0.6,main="mtcars weights",xlab="car weight (lb/1000)")
grid()

```


```{r, question3}
setosa <- subset(iris,Species=="setosa")
head(setosa)

virginica <- subset(iris,Species=="virginica")
head(virginica)

versicolor <- subset(iris,Species=="versicolor")
head(versicolor)

boxplot(list(setosa$Petal.Length,virginica$Petal.Length,versicolor$Petal.Length),names=c("Setosa","Virginica","Versicolor"),ylab="cm",main="Petal length")

```


## Checking my skills

For the TSV file located here: https://raw.githubusercontent.com/markziemann/SLE712_files/master/bioinfo_asst3_part1_files/mydata.tsv do the following:

1. Read it in and show the first 6 rows of data. 

2. Calculate the column and row means.

3. Use the `cor()` command to find the correlation coefficients between the 3 data sets. Which two datasets are the most similar?

4. Make a pairs plot of the three datasets.

## Answers to TSV file

```{r, tsv1}
URL="https://raw.githubusercontent.com/markziemann/SLE712_files/master/bioinfo_asst3_part1_files/mydata.tsv"
x <- read.table(URL,header=TRUE,row.names = 1)
head(x)
```

```{r,tsv2}
colMeans(x)
rowMeans(x)
```

```{r,tsv3}
cor(x)

library("gplots")
heatmap.2(cor(x),trace="none",scale="none",margins = c(15,15))
```

```{r,tsv4}
pairs(x)
```


```{r,sessioninfo}

sessionInfo()

```